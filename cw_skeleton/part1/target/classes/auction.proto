syntax = "proto3";

option java_multiple_files = true;
option java_package = "frontend";
option java_outer_classname = "AuctionProto";

message RegisterRequest {
  string email = 1;
}
message RegisterReply {
  int32 user_id = 1;
}

message NewAuctionRequest {
  int32 user_id = 1;
  string name = 2;
  string description = 3;
  int32 reserve_price = 4;
}
message NewAuctionReply {
  int32 item_id = 1;
}

message BidRequest {
  int32 user_id = 1;
  int32 item_id = 2;
  int32 price = 3;
}
message BidReply {
  bool success = 1;
}

message Empty {}

message Item {
  int32 item_id = 1;
  string name = 2;
  string description = 3;
  int32 reserve_price = 4;
  int32 highest_bid = 5;
}

message ListReply {
  repeated Item items = 1;
}

message CloseRequest {
  int32 user_id = 1;
  int32 item_id = 2;
}

message AuctionResult {
  int32 item_id = 1;
  int32 winning_user = 2;
  int32 price = 3;
}

message GetSpecRequest {
  int32 item_id = 1;
}

service AuctionService {
  rpc Register(RegisterRequest) returns (RegisterReply);
  rpc NewAuction(NewAuctionRequest) returns (NewAuctionReply);
  rpc Bid(BidRequest) returns (BidReply);
  rpc ListItems(Empty) returns (ListReply);
  rpc GetSpec(GetSpecRequest) returns (Item);
  rpc CloseAuction(CloseRequest) returns (AuctionResult); 
}
